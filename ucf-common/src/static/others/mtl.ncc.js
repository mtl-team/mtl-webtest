!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";let e={};const t={default_tp:"none",time_out:5e3,header:{}};function i({appId:t,success:i,fail:o,complete:n}){if(t&&"string"==typeof t){const c=e[t];if(c){let e={code:1,msg:"success",data:c};i&&i(e),n&&n(e)}else{let e={code:0,msg:"不存在此配置",data:c};o&&o(e),n&&n(e)}return c}{let e={code:0,msg:"appId不能为空，或者不是string",data:null};return o&&o(e),n&&n(e),null}}var o={appcontext:{token:"",devid:"",userid:"",massotoken:"",appid:"sso",funcid:"",groupid:"",sessionid:"",user:"",tabid:"",pass:""},servicecontext:{callback:"nothing",actionid:"umCommonService",params:{user:"a",pass:"a111111"},actionname:"load",viewid:"com.yonyou.ma.controller.CustomerController",controllerid:"com.yonyou.ma.controller.CustomerController"},deviceinfo:{os:"web",style:"web",isroot:!1,versionname:"",devid:"",name:"",ssid:"",appversion:"",mac:"",uuid:"",wfaddress:"",osversion:"",lang:"zh",ncdevid:""},serviceid:"UMSSOGetApps"};const n=require("axios"),c="/umserver/core";let a;function s(e){function t(t){e.fail&&e.fail(t),e.complete&&e.complete(t)}if(!e||"[object Object]"!==Object.prototype.toString.call(e)){return Promise.reject({code:0,msg:"请传入正确参数, type is Object"})}const{appId:s}=e;if(!s){let e={code:0,msg:"appId不能为空"};return t(e),Promise.reject(e)}let r=i({appId:s});r||(r={});const{host:l="",port:d="",isHttps:p=!1,default_tp:f="none",time_out:m=5e3,header:u}=r,{tp:g=f,viewId:v="",action:C="",serviceId:y,timeout:I=m,params:S={},header:h=u}=e;let w={deviceinfo:{...o.deviceinfo},appcontext:{...o.appcontext,appid:s},serviceid:y||o.serviceid,servicecontext:{...o.servicecontext,params:S,appid:s,viewid:v,actionname:C}};const b=l?`${p?"https://":"http://"}${l}${d?":"+d:""}`:"",O=a||c;a=void 0;const x=b+O,G=new FormData;return G.append("tp",g),G.append("data",JSON.stringify(w)),new Promise((i,o)=>{n({timeout:I,method:"POST",url:x,data:G,headers:{"Content-Type":"application/json",...h}}).then(function(n){const{data:{data:c}}=n,a=1*c.code,s={code:a,msg:c.msg,data:c.resultctx};var r;1===a?(r=s,e.success&&e.fail(r),e.complete&&e.complete(r),i(c)):(t(s),o(s))}).catch(function(e){let i={code:0,msg:e};t(i),o(i)})})}let r=[{api:"callAction",fn:s},{api:"callService",fn:function(e={}){return s({appId:e.appId,serviceId:e.serviceId,success:e.success,fail:e.fail,complete:e.complete})}},{api:"writeUCGConfig",fn:function({appId:i,config:o,success:n,fail:c,complete:a}){if(i&&"string"==typeof i){e[i]={...t,...o,appId:i};let c={code:1,msg:"success",data:o};n&&n(c),a&&a(c)}else{let e={code:1,msg:"appId不能为空，或者不是string",data:null};c&&c(e),a&&a(e)}}},{api:"readUCGConfig",fn:i},{api:"login",fn:function(e){const{params:t,...i}=e;return a="/umserver/SSOLogin",s({appId:"sso",action:"load",serviceid:"UMSSOGetApps",params:t,...i})}}],l=[{api:"writeUCGConfig",fn:function(e){mtlBridge.call("ucg.writeUCGConfig",JSON.stringify(e),e.callback)}},{api:"readUCGConfig",fn:function(e){mtlBridge.call("ucg.readUCGConfig",JSON.stringify(e),e.callback)}},{api:"callAction",fn:function(e){mtlBridge.call("ucg.callService",JSON.stringify(e),e.callback)}}];!function(){if(!mtl)throw Error("mtl is undefine!");let e=[];e="ios"==mtl.platform||"android"==mtl.platform?l:r;for(let t of e)mtl.register(t)}()});
